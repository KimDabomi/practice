{"ast":null,"code":"import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport axios from 'axios';\n\n/** Ajax처리를 위한 미들웨어 함수 정의 */\nexport const getKakaoSearch = createAsyncThunk('ImageSearchSlice/getKakaoSearch', async (payload, _ref) => {\n  let {\n    rejectWithValue\n  } = _ref;\n  let result = null;\n  try {\n    const response = await axios.get('https://dapi.kakao.com/v2/search/image', {\n      params: {\n        query: payload.query,\n        page: payload.page ? payload.page : 1\n      },\n      headers: {\n        Authorization: `KakaoAK 01b04af9132609f0fc0f2cdf32f46cf0`\n      }\n    });\n    result = response.data;\n  } catch (err) {\n    result = rejectWithValue(err.response);\n  }\n  return result;\n});\nconst ImageSearchSlice = createSlice({\n  name: 'ImageSearchSlice',\n  // 이 모듈이 관리하고자하는 상태값들을 명시\n  initialState: {\n    data: null,\n    loading: false,\n    error: null\n  },\n  // 상태값을 갱신하기 위한 함수들을 구현\n  // Ajax의 처리 과정에 따라 자동으로 실행된다.\n  // pending,fulfilled,rejected 한 세트!!!\n  extraReducers: {\n    // 로딩중임을 표시\n    [getKakaoSearch.pending]: (state, _ref2) => {\n      let {\n        payload\n      } = _ref2;\n      return {\n        ...state,\n        loading: true\n      };\n    },\n    // 처리가 완료된 경우 - 미들웨어 함수가 정상적으로 리턴한 경우\n    [getKakaoSearch.fulfilled]: (state, _ref3) => {\n      let {\n        meta,\n        payload\n      } = _ref3;\n      // action 함수의 meta에는 API에 요청시 전송한 파라미터가 포함되어 있다. 1페이지 이후의 검색 결과는 기존 데이터를 덧붙여야 한다.\n      if (meta.arg.page > 1) {\n        payload.documents = state.data.documents.concat(payload.documents);\n        console.log(`누적 데이터 길이=${payload.document.length}`);\n      }\n      return {\n        data: payload,\n        loading: false,\n        error: null\n      };\n    },\n    // 처리에 실패한 경우 - 미들웨어 함수 안에서 예외가 발생하여 catch블록이 실행된 경우\n    [getKakaoSearch.rejected]: (state, _ref4) => {\n      let {\n        payload\n      } = _ref4;\n      return {\n        ...state,\n        loading: false,\n        error: {\n          code: payload !== null && payload !== void 0 && payload.status ? payload.status : 500,\n          message: payload !== null && payload !== void 0 && payload.statusText ? payload.statusText : 'ServerError'\n        }\n      };\n    }\n  }\n});\nexport default ImageSearchSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","axios","getKakaoSearch","payload","rejectWithValue","result","response","get","params","query","page","headers","Authorization","data","err","ImageSearchSlice","name","initialState","loading","error","extraReducers","pending","state","fulfilled","meta","arg","documents","concat","console","log","document","length","rejected","code","status","message","statusText","reducer"],"sources":["C:/Users/cdabo/react/13-redux/src/slices/ImageSearchSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\r\nimport axios from 'axios';\r\n\r\n/** Ajax처리를 위한 미들웨어 함수 정의 */\r\nexport const getKakaoSearch = createAsyncThunk('ImageSearchSlice/getKakaoSearch', async (payload, { rejectWithValue }) => {\r\n    let result = null;\r\n\r\n    try {\r\n        const response = await axios.get('https://dapi.kakao.com/v2/search/image', {\r\n            params: {\r\n                query: payload.query,\r\n                page: payload.page ? payload.page : 1\r\n            },\r\n            headers: { Authorization: `KakaoAK 01b04af9132609f0fc0f2cdf32f46cf0` }\r\n        });\r\n        result = response.data;\r\n    } catch (err) {\r\n        result = rejectWithValue(err.response);\r\n    }\r\n    return result;\r\n});\r\n\r\n\r\nconst ImageSearchSlice = createSlice({\r\n    name: 'ImageSearchSlice',\r\n    // 이 모듈이 관리하고자하는 상태값들을 명시\r\n    initialState: {\r\n        data: null,\r\n        loading: false,\r\n        error: null\r\n    },\r\n    // 상태값을 갱신하기 위한 함수들을 구현\r\n    // Ajax의 처리 과정에 따라 자동으로 실행된다.\r\n    // pending,fulfilled,rejected 한 세트!!!\r\n    extraReducers: {\r\n         // 로딩중임을 표시\r\n        [getKakaoSearch.pending]: (state, { payload }) => {\r\n            return { ...state, loading: true }\r\n        },\r\n        // 처리가 완료된 경우 - 미들웨어 함수가 정상적으로 리턴한 경우\r\n        [getKakaoSearch.fulfilled]: (state, { meta,payload }) => {\r\n            // action 함수의 meta에는 API에 요청시 전송한 파라미터가 포함되어 있다. 1페이지 이후의 검색 결과는 기존 데이터를 덧붙여야 한다.\r\n            if (meta.arg.page > 1) {\r\n                payload.documents = state.data.documents.concat(payload.documents);\r\n                console.log(`누적 데이터 길이=${payload.document.length}`);\r\n            }\r\n            return {\r\n                data: payload, \r\n                loading: false,\r\n                error: null\r\n            }\r\n        },\r\n        // 처리에 실패한 경우 - 미들웨어 함수 안에서 예외가 발생하여 catch블록이 실행된 경우\r\n        [getKakaoSearch.rejected]: (state, { payload }) => {\r\n            return {\r\n                ...state, \r\n                loading: false,\r\n                error: {\r\n                    code: (payload?.status) ? (payload.status) : 500,\r\n                    message: (payload?.statusText) ? (payload.statusText) : 'ServerError'\r\n                }\r\n            }\r\n        }\r\n    }\r\n});\r\nexport default ImageSearchSlice.reducer;\r\n"],"mappings":"AAAA,SAASA,WAAW,EAAEC,gBAAgB,QAAQ,kBAAkB;AAChE,OAAOC,KAAK,MAAM,OAAO;;AAEzB;AACA,OAAO,MAAMC,cAAc,GAAGF,gBAAgB,CAAC,iCAAiC,EAAE,OAAOG,OAAO,WAA0B;EAAA,IAAxB;IAAEC;EAAgB,CAAC;EACjH,IAAIC,MAAM,GAAG,IAAI;EAEjB,IAAI;IACA,MAAMC,QAAQ,GAAG,MAAML,KAAK,CAACM,GAAG,CAAC,wCAAwC,EAAE;MACvEC,MAAM,EAAE;QACJC,KAAK,EAAEN,OAAO,CAACM,KAAK;QACpBC,IAAI,EAAEP,OAAO,CAACO,IAAI,GAAGP,OAAO,CAACO,IAAI,GAAG;MACxC,CAAC;MACDC,OAAO,EAAE;QAAEC,aAAa,EAAG;MAA0C;IACzE,CAAC,CAAC;IACFP,MAAM,GAAGC,QAAQ,CAACO,IAAI;EAC1B,CAAC,CAAC,OAAOC,GAAG,EAAE;IACVT,MAAM,GAAGD,eAAe,CAACU,GAAG,CAACR,QAAQ,CAAC;EAC1C;EACA,OAAOD,MAAM;AACjB,CAAC,CAAC;AAGF,MAAMU,gBAAgB,GAAGhB,WAAW,CAAC;EACjCiB,IAAI,EAAE,kBAAkB;EACxB;EACAC,YAAY,EAAE;IACVJ,IAAI,EAAE,IAAI;IACVK,OAAO,EAAE,KAAK;IACdC,KAAK,EAAE;EACX,CAAC;EACD;EACA;EACA;EACAC,aAAa,EAAE;IACV;IACD,CAAClB,cAAc,CAACmB,OAAO,GAAG,CAACC,KAAK,YAAkB;MAAA,IAAhB;QAAEnB;MAAQ,CAAC;MACzC,OAAO;QAAE,GAAGmB,KAAK;QAAEJ,OAAO,EAAE;MAAK,CAAC;IACtC,CAAC;IACD;IACA,CAAChB,cAAc,CAACqB,SAAS,GAAG,CAACD,KAAK,YAAuB;MAAA,IAArB;QAAEE,IAAI;QAACrB;MAAQ,CAAC;MAChD;MACA,IAAIqB,IAAI,CAACC,GAAG,CAACf,IAAI,GAAG,CAAC,EAAE;QACnBP,OAAO,CAACuB,SAAS,GAAGJ,KAAK,CAACT,IAAI,CAACa,SAAS,CAACC,MAAM,CAACxB,OAAO,CAACuB,SAAS,CAAC;QAClEE,OAAO,CAACC,GAAG,CAAE,aAAY1B,OAAO,CAAC2B,QAAQ,CAACC,MAAO,EAAC,CAAC;MACvD;MACA,OAAO;QACHlB,IAAI,EAAEV,OAAO;QACbe,OAAO,EAAE,KAAK;QACdC,KAAK,EAAE;MACX,CAAC;IACL,CAAC;IACD;IACA,CAACjB,cAAc,CAAC8B,QAAQ,GAAG,CAACV,KAAK,YAAkB;MAAA,IAAhB;QAAEnB;MAAQ,CAAC;MAC1C,OAAO;QACH,GAAGmB,KAAK;QACRJ,OAAO,EAAE,KAAK;QACdC,KAAK,EAAE;UACHc,IAAI,EAAG9B,OAAO,aAAPA,OAAO,eAAPA,OAAO,CAAE+B,MAAM,GAAK/B,OAAO,CAAC+B,MAAM,GAAI,GAAG;UAChDC,OAAO,EAAGhC,OAAO,aAAPA,OAAO,eAAPA,OAAO,CAAEiC,UAAU,GAAKjC,OAAO,CAACiC,UAAU,GAAI;QAC5D;MACJ,CAAC;IACL;EACJ;AACJ,CAAC,CAAC;AACF,eAAerB,gBAAgB,CAACsB,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}